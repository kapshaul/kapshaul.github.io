<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Online Learning - Discounted UCB | Yong-Hwan Lee</title>
<meta name="keywords" content="Linear Regression, Online Learning, Recommendation System, UCB">
<meta name="description" content="This study was carried out as a project at Oregon State University.">
<meta name="author" content="Yong-Hwan Lee">
<link rel="canonical" href="http://localhost:1313/studies/discount-ucb/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6cf4a8fa527330d9574f36d8d000fdaf90ca838ff09ab72fc27d3cb7ca1ddc5.css" integrity="sha256-1s9Kj6UnMw2VdPNtjQAP2vkMqDj/Caty/CfTy3yh3cU=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/studies/discount-ucb/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Online Learning - Discounted UCB" />
<meta property="og:description" content="This study was carried out as a project at Oregon State University." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/studies/discount-ucb/" /><meta property="article:section" content="studies" />
<meta property="article:published_time" content="2023-12-03T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-12-03T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Online Learning - Discounted UCB"/>
<meta name="twitter:description" content="This study was carried out as a project at Oregon State University."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Studies",
      "item": "http://localhost:1313/studies/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Online Learning - Discounted UCB",
      "item": "http://localhost:1313/studies/discount-ucb/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Online Learning - Discounted UCB",
  "name": "Online Learning - Discounted UCB",
  "description": "This study was carried out as a project at Oregon State University.",
  "keywords": [
    "Linear Regression", "Online Learning", "Recommendation System", "UCB"
  ],
  "articleBody": "Overview The focus of this study is to report the performance of Upper Confidence Bound (UCB) and discounted UCB with different choices of the discount factor (γ).\n1. Theoretical Aspect of the Effect of γ In discounted UCB, recent and previous observations are weighted differently based on the discount factor γ. The weight for an observation decreases as it gets further in the past. This is represented by the term γt−j, which is large when j is close to t, meaning recent observations significantly affect the estimate μ̂. Conversely, past observations far from the present time sequence t have minimal impact.\nγ close to 1: Minimal discounting of past observations, equivalent to standard UCB. γ close to 0: Significant discounting, primarily considering only the most recent observation. When the environment changes suddenly after a time step T/2, relying on previous observations becomes less effective. Thus, a properly chosen γ in discounted UCB can outperform standard UCB by reducing dependence on outdated observations.\n2. Empirical Aspect of the Effect of γ Empirical results show that:\nUCB exhibits the highest cumulative regret. Discounted UCB generally shows lower regret. The performance difference between γ = 0.1 and γ = 0.5 is not substantial. γ = 0.9 leads to higher cumulative regrets compared to the other two values of γ. Given the sudden change in the reward function after T/2, past observations become less relevant, making discounted UCB a better choice than UCB. However, γ = 0.9 might be too large as it overly relies on past observations.\nImplementation Clone the repository. To run the simulation, execute the Simulation.py script. Results Cumulative Regret of UCB and Discounted UCB The table below summarizes the cumulative regrets for UCB and discounted UCB with different γ values across multiple trials.\nTrial UCB DUCB (γ = 0.1) DUCB (γ = 0.5) DUCB (γ = 0.9) 1 11 3 4 6 2 37 3 2 6 3 59 4 2 7 4 8 3 2 3 5 12 2 2 7 Cumulative Regret Plots Figure 1: Cumulative regrets of UCB\n(a) γ = 0.1\n(b) γ = 0.5\n(c) γ = 0.9\nFigure 2: Cumulative regret of discounted UCB with different γ values\nConclusion The results suggest that discounted UCB with a properly chosen γ can significantly reduce cumulative regret compared to standard UCB, especially in environments with sudden changes.\n",
  "wordCount" : "391",
  "inLanguage": "en",
  "datePublished": "2023-12-03T00:00:00Z",
  "dateModified": "2023-12-03T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Yong-Hwan Lee"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/studies/discount-ucb/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Yong-Hwan Lee",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            {left: "\\begin{equation}", right: "\\end{equation}", display: true},
            {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
            {left: "\\begin{align}", right: "\\end{align}", display: true},
            {left: "\\begin{align*}", right: "\\end{align*}", display: true},
            {left: "\\begin{alignat}", right: "\\end{alignat}", display: true},
            {left: "\\begin{gather}", right: "\\end{gather}", display: true},
            {left: "\\begin{CD}", right: "\\end{CD}", display: true},
          ],
          throwOnError : false
        });
    });
</script>
 


</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Yong-Hwan Lee">
                <img src="http://localhost:1313/favicon.ico" alt="" aria-label="logo"
                    height="18"
                    width="18">Yong-Hwan Lee</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/studies/" title="Studies">
                    <span>Studies</span>
                </a>
            </li>
        </ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Online Learning - Discounted UCB
    </h1>
    <div class="post-meta"><span title='2023-12-03 00:00:00 +0000 UTC'>December 2023</span>&nbsp;&middot;&nbsp;Yong-Hwan Lee&nbsp;&middot;&nbsp;<a href="https://github.com/kapshaul/OnlineLearning/tree/discountedUCB" rel="noopener noreferrer" target="_blank">GitHub</a>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#implementation">Implementation</a></li>
    <li><a href="#results">Results</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="overview">Overview<a hidden class="anchor" aria-hidden="true" href="#overview">#</a></h2>
<p>The focus of this study is to report the performance of Upper Confidence Bound (UCB) and discounted UCB with different choices of the discount factor (γ).</p>
<h4 id="1-theoretical-aspect-of-the-effect-of-γ">1. Theoretical Aspect of the Effect of γ<a hidden class="anchor" aria-hidden="true" href="#1-theoretical-aspect-of-the-effect-of-γ">#</a></h4>
<p>In discounted UCB, recent and previous observations are weighted differently based on the discount factor γ. The weight for an observation decreases as it gets further in the past. This is represented by the term γ<sup>t−j</sup>, which is large when j is close to t, meaning recent observations significantly affect the estimate μ̂. Conversely, past observations far from the present time sequence t have minimal impact.</p>
<ul>
<li><strong>γ close to 1</strong>: Minimal discounting of past observations, equivalent to standard UCB.</li>
<li><strong>γ close to 0</strong>: Significant discounting, primarily considering only the most recent observation.</li>
</ul>
<p>When the environment changes suddenly after a time step T/2, relying on previous observations becomes less effective. Thus, a properly chosen γ in discounted UCB can outperform standard UCB by reducing dependence on outdated observations.</p>
<h4 id="2-empirical-aspect-of-the-effect-of-γ">2. Empirical Aspect of the Effect of γ<a hidden class="anchor" aria-hidden="true" href="#2-empirical-aspect-of-the-effect-of-γ">#</a></h4>
<p>Empirical results show that:</p>
<ul>
<li>UCB exhibits the highest cumulative regret.</li>
<li>Discounted UCB generally shows lower regret.</li>
<li>The performance difference between γ = 0.1 and γ = 0.5 is not substantial.</li>
<li>γ = 0.9 leads to higher cumulative regrets compared to the other two values of γ.</li>
</ul>
<p>Given the sudden change in the reward function after T/2, past observations become less relevant, making discounted UCB a better choice than UCB. However, γ = 0.9 might be too large as it overly relies on past observations.</p>
<h2 id="implementation">Implementation<a hidden class="anchor" aria-hidden="true" href="#implementation">#</a></h2>
<ol>
<li>Clone the repository.</li>
<li>To run the simulation, execute the <code>Simulation.py</code> script.</li>
</ol>
<h2 id="results">Results<a hidden class="anchor" aria-hidden="true" href="#results">#</a></h2>
<h4 id="cumulative-regret-of-ucb-and-discounted-ucb">Cumulative Regret of UCB and Discounted UCB<a hidden class="anchor" aria-hidden="true" href="#cumulative-regret-of-ucb-and-discounted-ucb">#</a></h4>
<p>The table below summarizes the cumulative regrets for UCB and discounted UCB with different γ values across multiple trials.</p>
<div align="center">
<table>
  <thead>
      <tr>
          <th>Trial</th>
          <th style="text-align: center">UCB</th>
          <th style="text-align: center">DUCB (γ = 0.1)</th>
          <th style="text-align: center">DUCB (γ = 0.5)</th>
          <th style="text-align: center">DUCB (γ = 0.9)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td style="text-align: center">11</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">4</td>
          <td style="text-align: center">6</td>
      </tr>
      <tr>
          <td>2</td>
          <td style="text-align: center">37</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">6</td>
      </tr>
      <tr>
          <td>3</td>
          <td style="text-align: center">59</td>
          <td style="text-align: center">4</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">7</td>
      </tr>
      <tr>
          <td>4</td>
          <td style="text-align: center">8</td>
          <td style="text-align: center">3</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">3</td>
      </tr>
      <tr>
          <td>5</td>
          <td style="text-align: center">12</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">2</td>
          <td style="text-align: center">7</td>
      </tr>
  </tbody>
</table>
</div>
<h4 id="cumulative-regret-plots">Cumulative Regret Plots<a hidden class="anchor" aria-hidden="true" href="#cumulative-regret-plots">#</a></h4>
<div align="center">
<div style="display: flex; gap: 10px; justify-content: center; align-items: flex-start; flex-wrap: wrap;">
  <div style="text-align: center;">
    <img src="/discount-ucb/UCB1.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/UCB2.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/UCB3.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/UCB4.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/UCB5.png" width="230">
  </div>
</div>
<p><strong>Figure 1</strong>: Cumulative regrets of UCB</p>
<br>
<br>
<br>
<p>(a) γ = 0.1</p>
<div style="display: flex; gap: 10px; justify-content: center; align-items: flex-start; flex-wrap: wrap;">
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB1_01.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB2_01.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB3_01.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB4_01.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB5_01.png" width="230">
  </div>
</div>
<br>
<br>
<p>(b) γ = 0.5</p>
<div style="display: flex; gap: 10px; justify-content: center; align-items: flex-start; flex-wrap: wrap;">
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB1_05.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB2_05.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB3_05.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB4_05.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB5_05.png" width="230">
  </div>
</div>
<br>
<br>
<p>(c) γ = 0.9</p>
<div style="display: flex; gap: 10px; justify-content: center; align-items: flex-start; flex-wrap: wrap;">
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB1_09.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB2_09.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB3_09.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB4_09.png" width="230">
  </div>
  <div style="text-align: center;">
    <img src="/discount-ucb/DUCB5_09.png" width="230">
  </div>
</div>
<p><strong>Figure 2</strong>: Cumulative regret of discounted UCB with different γ values</p>
</div>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>The results suggest that discounted UCB with a properly chosen γ can significantly reduce cumulative regret compared to standard UCB, especially in environments with sudden changes.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/linear-regression/">Linear Regression</a></li>
      <li><a href="http://localhost:1313/tags/online-learning/">Online Learning</a></li>
      <li><a href="http://localhost:1313/tags/recommendation-system/">Recommendation System</a></li>
      <li><a href="http://localhost:1313/tags/ucb/">UCB</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="http://localhost:1313/">Yong-Hwan Lee</a></span> ·     
    <span>
    Powered by 
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/pmichaillat/hugo-website/" rel="noopener" target="_blank">a modified version</a>
         of 
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>
</html>
